# Story 1.6: Implement My Tasks Widget & Communication Log

## Status
Draft

## Story
**As a** CMT member,
**I want** to see my assigned tasks on the dashboard and post formal updates,
**so that** I can focus on my work and keep the team informed.

## Acceptance Criteria
1. The "My Tasks" widget on the dashboard is populated with tasks assigned only to the logged-in user.
2. A "Communication" page is created with a form to submit new announcements.
3. Submitted announcements are displayed in a chronological, view-only log.
4. Posting a new communication generates a new event in the Activity Log.

## Tasks / Subtasks
- [ ] Implement My Tasks dashboard widget (AC: 1)
  - [ ] Create My Tasks widget component for dashboard
  - [ ] Filter tasks by current logged-in user
  - [ ] Display task description, priority, due date, and status
  - [ ] Add quick status update functionality (mark as completed)
  - [ ] Limit display to top 5-10 most relevant tasks
  - [ ] Add "View All My Tasks" link to navigate to filtered All Tasks page
- [ ] Create Communication page structure (AC: 2)
  - [ ] Set up Next.js page route for /communications
  - [ ] Create page layout with announcement form and log sections
  - [ ] Add main navigation link to Communications
  - [ ] Ensure proper authentication and role-based access
- [ ] Implement announcement creation form (AC: 2)
  - [ ] Create announcement form with title and message fields
  - [ ] Add announcement priority/type selection (Info, Important, Critical)
  - [ ] Add rich text formatting options for message content
  - [ ] Implement form validation (required fields, character limits)
  - [ ] Add confirmation dialog before posting
- [ ] Implement communication log display (AC: 3)
  - [ ] Display announcements in reverse chronological order
  - [ ] Show announcement title, message, author, timestamp, and priority
  - [ ] Apply visual styling based on priority/type
  - [ ] Implement read-only view with no edit/delete options
  - [ ] Add pagination for long communication logs
- [ ] Implement database operations for communications (AC: 2, 3)
  - [ ] Create Supabase database table for communications/announcements
  - [ ] Add foreign key relationship to users (author)
  - [ ] Implement API endpoints for communication CRUD operations
  - [ ] Add proper database constraints and indexes
- [ ] Integrate with Activity Log (AC: 4)
  - [ ] Create activity log entry when new announcement is posted
  - [ ] Include announcement title and author in log entry
  - [ ] Ensure real-time updates appear on dashboard Activity Log
  - [ ] Add appropriate activity type categorization

## Dev Notes
### Architecture Context
- **Technology Stack**: Next.js with TypeScript, Tailwind CSS, Supabase PostgreSQL
- **State Management**: Zustand for managing communications and My Tasks widget state
- **UI Components**: Headless UI for form components and rich text editor
- **Real-time**: Supabase real-time subscriptions for live updates

### Communication Context
The Communication module serves as the official announcement system for the crisis team. It provides a centralized location for formal updates, directives, and important information that needs to reach all team members. This is distinct from informal chat or discussion systems.

### Dashboard Widget Integration
The My Tasks widget complements the existing Crisis Summary and Activity Log widgets established in Story 1.2. It should follow the same visual design patterns and responsive behavior.

### Integration Points
- **Task System**: My Tasks widget displays tasks created in Story 1.5
- **User Authentication**: Leverage Supabase Auth for user identification and announcement authorship
- **Dashboard Layout**: Integrate My Tasks widget into existing dashboard grid
- **Activity Log**: Communications appear in the central Activity Log feed

### Database Schema Considerations
Communications table should include:
- id, title, message, author_id, priority/type
- created_at, updated_at
- Proper indexing for chronological queries

### Testing
**Test Standards**:
- Unit tests using Vitest and React Testing Library
- Test files located alongside components with `.test.tsx` extension
- E2E tests using Playwright for complete communication workflows
- Real-time functionality testing with multiple user sessions

**Testing Requirements**:
- Test My Tasks widget filters tasks correctly for logged-in user
- Test My Tasks widget quick status updates
- Test communication form validation and submission
- Test communication log display and pagination
- Test Activity Log integration for new communications
- Test real-time updates across different user sessions
- Test responsive design for dashboard widget and communications page

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-12 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here after implementation*