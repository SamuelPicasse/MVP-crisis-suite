# Story 1.5: Implement Core Task Management

## Status
Draft

## Story
**As a** CMT member,
**I want** to create tasks from decisions and assign them to users,
**so that** we can manage our response actions effectively.

## Acceptance Criteria
1. From a "Decision" entry in the BOB model, a user has an option to "Create Task".
2. The task creation form allows for a description and assignment to another system user.
3. A central "All Tasks" page is created that displays a list of all tasks, their assignees, and status.
4. Creating a task generates a new event in the Activity Log.

## Tasks / Subtasks
- [ ] Add task creation from BOB decisions (AC: 1)
  - [ ] Add "Create Task" button/link to Decision entries in BOB model
  - [ ] Pre-populate task description with decision context
  - [ ] Navigate to task creation form with BOB context
  - [ ] Link created task back to originating BOB decision
- [ ] Implement task creation form (AC: 2)
  - [ ] Create task creation modal/page with form fields
  - [ ] Add task description input (required, character limit)
  - [ ] Add user assignment dropdown (fetch from Supabase Auth)
  - [ ] Add task priority selection (Low, Medium, High, Urgent)
  - [ ] Add due date picker (optional)
  - [ ] Implement form validation and error handling
- [ ] Create All Tasks page (AC: 3)
  - [ ] Set up Next.js page route for /tasks
  - [ ] Create task list view with sortable columns
  - [ ] Display task description, assignee, status, priority, due date
  - [ ] Add filtering options (by assignee, status, priority)
  - [ ] Add search functionality for task descriptions
  - [ ] Implement task status updates (Not Started, In Progress, Completed)
- [ ] Implement task database operations (AC: 2, 3)
  - [ ] Create Supabase database table for tasks
  - [ ] Add foreign key relationships to users and BOB entries
  - [ ] Implement API endpoints for task CRUD operations
  - [ ] Add proper database constraints and indexes
- [ ] Integrate with Activity Log (AC: 4)
  - [ ] Create activity log entry when task is created
  - [ ] Include task details and assignee in log entry
  - [ ] Create activity log entry when task status changes
  - [ ] Ensure real-time updates on dashboard Activity Log

## Dev Notes
### Architecture Context
- **Technology Stack**: Next.js with TypeScript, Tailwind CSS, Supabase PostgreSQL
- **State Management**: Zustand for task state management and real-time updates
- **UI Components**: Headless UI for form components and modals
- **Authentication**: Supabase Auth for user management and assignment

### Task Management Context
Tasks are actionable items that emerge from BOB model decisions. They represent concrete actions that team members need to complete during crisis response. Each task maintains a clear audit trail back to its originating decision.

### Integration Points
- **BOB Model Integration**: Tasks created from Decision entries with context preservation
- **User Management**: Leverage Supabase Auth user records for task assignment
- **Dashboard Integration**: Activity Log displays task-related events
- **Navigation**: Main navigation includes link to All Tasks page

### Database Schema Considerations
Tasks table should include:
- id, description, assignee_id, creator_id, bob_entry_id (optional)
- status (enum: not_started, in_progress, completed)
- priority (enum: low, medium, high, urgent)
- due_date, created_at, updated_at

### Testing
**Test Standards**:
- Unit tests using Vitest and React Testing Library
- Test files located alongside components with `.test.tsx` extension  
- E2E tests using Playwright for complete task workflows
- Database operation testing with proper cleanup

**Testing Requirements**:
- Test task creation from BOB decisions with proper context linking
- Test task assignment to different users
- Test All Tasks page filtering and sorting functionality
- Test task status updates and Activity Log integration
- Test form validation and error handling
- Test real-time updates across different user sessions

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-12 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here after implementation*